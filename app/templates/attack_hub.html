<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <title>æ”»å‡»æµ‹è¯•ä¸­å¿ƒ</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
    }
    .category-section {
      background: rgba(255,255,255,0.95);
      border-radius: 16px;
      padding: 24px;
      margin-bottom: 24px;
      box-shadow: 0 8px 32px rgba(0,0,0,0.1);
    }
    .category-header {
      display: flex;
      align-items: center;
      margin-bottom: 20px;
      padding-bottom: 12px;
      border-bottom: 2px solid #e9ecef;
    }
    .category-icon {
      font-size: 32px;
      margin-right: 12px;
    }
    .attack-card {
      background: #fff;
      border: 2px solid #e9ecef;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
      transition: all 0.3s;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }
    .attack-card:hover {
      border-color: #667eea;
      transform: translateY(-4px);
      box-shadow: 0 8px 24px rgba(102,126,234,0.2);
    }
    .attack-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 4px;
      height: 100%;
      background: linear-gradient(180deg, #667eea 0%, #764ba2 100%);
    }
    .attack-card h4 {
      margin: 0 0 8px 0;
      color: #333;
      font-size: 18px;
    }
    .attack-card p {
      margin: 0;
      color: #6c757d;
      font-size: 14px;
    }
    .severity-badge {
      position: absolute;
      top: 16px;
      right: 16px;
      font-size: 11px;
      padding: 4px 8px;
    }
    .stats-card {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      border-radius: 12px;
      padding: 20px;
      margin-bottom: 16px;
    }
    .stats-card h3 {
      font-size: 32px;
      margin: 0;
      font-weight: bold;
    }
    .stats-card p {
      margin: 0;
      opacity: 0.9;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div class="container" style="max-width: 1400px;">
    <div class="text-center mb-4">
      <h1 class="text-white mb-2"><i class="bi bi-shield-exclamation"></i> æ”»å‡»æµ‹è¯•ä¸­å¿ƒ</h1>
      <p class="text-white-50">å…¨é¢çš„ Web å®‰å…¨æ”»å‡»æµ‹è¯•å¹³å°</p>
    </div>

    <div class="row mb-4">
      <div class="col-md-3">
        <div class="stats-card">
          <h3 id="totalAttacks">0</h3>
          <p>æ€»æ”»å‡»æ¬¡æ•°</p>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stats-card" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
          <h3 id="blockedAttacks">0</h3>
          <p>å·²æ‹¦æˆªæ”»å‡»</p>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stats-card" style="background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);">
          <h3 id="attackTypes">7</h3>
          <p>æ”»å‡»ç±»å‹</p>
        </div>
      </div>
      <div class="col-md-3">
        <div class="stats-card" style="background: linear-gradient(135deg, #a8edea 0%, #fed6e3 100%);">
          <h3 id="defenseRate">0%</h3>
          <p>é˜²å¾¡æˆåŠŸç‡</p>
        </div>
      </div>
    </div>

    <div class="category-section">
      <div class="category-header">
        <span class="category-icon">ğŸ’‰</span>
        <div>
          <h2 class="mb-0">æ³¨å…¥ç±»æ”»å‡» (Injection Attacks)</h2>
          <p class="text-muted mb-0">é€šè¿‡æ³¨å…¥æ¶æ„ä»£ç æ¥æ“çºµåº”ç”¨ç¨‹åºè¡Œä¸º</p>
        </div>
      </div>
      
      <div class="row">
        <div class="col-md-4">
          <div class="attack-card" onclick="location.href='{{ url_for('test_xss_page') }}'">
            <span class="severity-badge badge bg-danger">HIGH</span>
            <h4><i class="bi bi-code-slash"></i> XSS è·¨ç«™è„šæœ¬</h4>
            <p>åå°„å‹ã€å­˜å‚¨å‹ã€DOMå‹ XSS æ”»å‡»æµ‹è¯•</p>
            <div class="mt-2">
              <span class="badge bg-secondary me-1">åå°„å‹</span>
              <span class="badge bg-secondary me-1">å­˜å‚¨å‹</span>
              <span class="badge bg-secondary">DOMå‹</span>
            </div>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="attack-card" onclick="location.href='{{ url_for('test_sqli') }}'">
            <span class="severity-badge badge bg-danger">CRITICAL</span>
            <h4><i class="bi bi-database-fill-exclamation"></i> SQL æ³¨å…¥</h4>
            <p>æ•°æ®åº“æŸ¥è¯¢æ³¨å…¥ã€è”åˆæŸ¥è¯¢ã€ç›²æ³¨æµ‹è¯•</p>
            <div class="mt-2">
              <span class="badge bg-secondary me-1">ç»å…¸æ³¨å…¥</span>
              <span class="badge bg-secondary me-1">UNION</span>
              <span class="badge bg-secondary">ç›²æ³¨</span>
            </div>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="attack-card" onclick="location.href='{{ url_for('test_cmdi') }}'">
            <span class="severity-badge badge bg-danger">CRITICAL</span>
            <h4><i class="bi bi-terminal"></i> å‘½ä»¤æ³¨å…¥</h4>
            <p>æ“ä½œç³»ç»Ÿå‘½ä»¤æ‰§è¡Œã€åå¼¹Shellæµ‹è¯•</p>
            <div class="mt-2">
              <span class="badge bg-secondary me-1">åˆ†å·æ³¨å…¥</span>
              <span class="badge bg-secondary me-1">ç®¡é“ç¬¦</span>
              <span class="badge bg-secondary">å‘½ä»¤æ›¿æ¢</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="category-section">
      <div class="category-header">
        <span class="category-icon">ğŸš«</span>
        <div>
          <h2 class="mb-0">è®¿é—®æ§åˆ¶æ”»å‡» (Access Control)</h2>
          <p class="text-muted mb-0">è¯•å›¾è®¿é—®æœªæˆæƒçš„èµ„æºæˆ–æ–‡ä»¶</p>
        </div>
      </div>
      
      <div class="row">
        <div class="col-md-4">
          <div class="attack-card" onclick="location.href='{{ url_for('test_path_traversal') }}'">
            <span class="severity-badge badge bg-warning text-dark">HIGH</span>
            <h4><i class="bi bi-folder2-open"></i> ç›®å½•éå†</h4>
            <p>è·¯å¾„éå†ã€æ•æ„Ÿæ–‡ä»¶è®¿é—®æµ‹è¯•</p>
            <div class="mt-2">
              <span class="badge bg-secondary me-1">ç›¸å¯¹è·¯å¾„</span>
              <span class="badge bg-secondary me-1">ç¼–ç ç»•è¿‡</span>
              <span class="badge bg-secondary">ç»å¯¹è·¯å¾„</span>
            </div>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="attack-card" style="opacity: 0.6; cursor: not-allowed;">
            <span class="severity-badge badge bg-warning text-dark">MEDIUM</span>
            <h4><i class="bi bi-key"></i> æƒé™æå‡</h4>
            <p>å‚ç›´/æ°´å¹³æƒé™æå‡æµ‹è¯• (å³å°†æ¨å‡º)</p>
            <div class="mt-2">
              <span class="badge bg-secondary">å¼€å‘ä¸­</span>
            </div>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="attack-card" style="opacity: 0.6; cursor: not-allowed;">
            <span class="severity-badge badge bg-warning text-dark">HIGH</span>
            <h4><i class="bi bi-file-lock"></i> æ–‡ä»¶ä¸Šä¼ </h4>
            <p>æ¶æ„æ–‡ä»¶ä¸Šä¼ ã€WebShellæµ‹è¯• (å³å°†æ¨å‡º)</p>
            <div class="mt-2">
              <span class="badge bg-secondary">å¼€å‘ä¸­</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="category-section">
      <div class="category-header">
        <span class="category-icon">â±ï¸</span>
        <div>
          <h2 class="mb-0">è¡Œä¸ºåˆ†ææ”»å‡» (Behavioral Analysis)</h2>
          <p class="text-muted mb-0">é€šè¿‡å¼‚å¸¸è¡Œä¸ºæ¨¡å¼è¿›è¡Œçš„æ”»å‡»</p>
        </div>
      </div>
      
      <div class="row">
        <div class="col-md-4">
          <div class="attack-card" onclick="location.href='/attack/auth_security'">
            <span class="severity-badge badge bg-warning text-dark">HIGH</span>
            <h4><i class="bi bi-person-badge"></i> è®¤è¯ä¸ä¼šè¯ç®¡ç†</h4>
            <p>æš´åŠ›ç ´è§£/æ’åº“ã€å¼±å£ä»¤æ£€æµ‹ã€ä¼šè¯åŠ«æŒé˜²æŠ¤æ¼”ç¤º</p>
            <div class="mt-2">
              <span class="badge bg-secondary me-1">æš´åŠ›ç ´è§£</span>
              <span class="badge bg-secondary me-1">å¼±å£ä»¤</span>
              <span class="badge bg-secondary">ä¼šè¯åŠ«æŒ</span>
            </div>
          </div>
        </div>

        <div class="col-md-4">
          <div class="attack-card" style="opacity: 0.6; cursor: not-allowed;">
            <span class="severity-badge badge bg-warning text-dark">HIGH</span>
            <h4><i class="bi bi-lock"></i> æš´åŠ›ç ´è§£</h4>
            <p>å¯†ç çˆ†ç ´ã€é¢‘ç‡é™åˆ¶æµ‹è¯• (å³å°†æ¨å‡º)</p>
            <div class="mt-2">
              <span class="badge bg-secondary">å¼€å‘ä¸­</span>
            </div>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="attack-card" style="opacity: 0.6; cursor: not-allowed;">
            <span class="severity-badge badge bg-info">MEDIUM</span>
            <h4><i class="bi bi-arrow-repeat"></i> DoS æ”»å‡»</h4>
            <p>æ‹’ç»æœåŠ¡ã€èµ„æºè€—å°½æµ‹è¯• (å³å°†æ¨å‡º)</p>
            <div class="mt-2">
              <span class="badge bg-secondary">å¼€å‘ä¸­</span>
            </div>
          </div>
        </div>
        
        <div class="col-md-4">
          <div class="attack-card" style="opacity: 0.6; cursor: not-allowed;">
            <span class="severity-badge badge bg-info">MEDIUM</span>
            <h4><i class="bi bi-robot"></i> çˆ¬è™«æ£€æµ‹</h4>
            <p>æ¶æ„çˆ¬è™«ã€Botæ£€æµ‹æµ‹è¯• (å³å°†æ¨å‡º)</p>
            <div class="mt-2">
              <span class="badge bg-secondary">å¼€å‘ä¸­</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="text-center mt-4">
      <a href="{{ url_for('console') }}" class="btn btn-outline-light btn-lg me-2">
        <i class="bi bi-speedometer2"></i> æ§åˆ¶å°
      </a>
      <a href="{{ url_for('dashboard') }}" class="btn btn-outline-light btn-lg">
        <i class="bi bi-graph-up"></i> æ•°æ®åˆ†æ
      </a>
    </div>
  </div>

  <script>
    async function loadStats() {
      try {
        const r = await fetch('/api/attack/stats');
        const data = await r.json();
        
        document.getElementById('totalAttacks').textContent = data.total || 0;
        document.getElementById('blockedAttacks').textContent = data.blocked || 0;
        document.getElementById('attackTypes').textContent = data.types || 7;
        
        const rate = data.total > 0 ? Math.round((data.blocked / data.total) * 100) : 0;
        document.getElementById('defenseRate').textContent = rate + '%';
      } catch(e) {
        console.error('Failed to load stats:', e);
      }
    }
    
    loadStats();
    setInterval(loadStats, 5000);
  </script>
</body>
</html>
